



<!doctype html>
<html lang="fa" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="کپی کردن">
      
        <meta name="lang:clipboard.copied" content="کپی شد">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="False">
      
        <meta name="lang:search.pipeline.trimmer" content="False">
      
        <meta name="lang:search.result.none" content="سندی یافت نشد">
      
        <meta name="lang:search.result.one" content="1 سند یافت شد">
      
        <meta name="lang:search.result.other" content="# سند یافت شد">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
    
      
        <title>فصل ۱۹ - تفکر پایتونی</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.1b62728e.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="rtl">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#_1" tabindex="1" class="md-skip">
        پرش به محتویات
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="تفکر پایتونی" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              تفکر پایتونی
            </span>
            <span class="md-header-nav__topic">
              
                فصل ۱۹
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="جستجو" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            برای شروع جستجو تایپ کنید
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="تفکر پایتونی" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    تفکر پایتونی
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="مقدمه" class="md-nav__link">
      مقدمه
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../chapter-01/" title="فصل اول" class="md-nav__link">
      فصل اول
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../chapter-02/" title="فصل دوم" class="md-nav__link">
      فصل دوم
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../chapter-03/" title="فصل سه" class="md-nav__link">
      فصل سه
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../chapter-04/" title="فصل چهارم" class="md-nav__link">
      فصل چهارم
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../chapter-05/" title="فصل پنجم" class="md-nav__link">
      فصل پنجم
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../chapter-06/" title="فصل ششم" class="md-nav__link">
      فصل ششم
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../chapter-07/" title="فصل ۷" class="md-nav__link">
      فصل ۷
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../chapter-08/" title="فصل ۸" class="md-nav__link">
      فصل ۸
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../chapter-09/" title="فصل ۹" class="md-nav__link">
      فصل ۹
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../chapter-10/" title="فصل ۱۰" class="md-nav__link">
      فصل ۱۰
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../chapter-11/" title="فصل 11" class="md-nav__link">
      فصل 11
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../chapter-12/" title="فصل ۱۲" class="md-nav__link">
      فصل ۱۲
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../chapter-13/" title="فصل 13" class="md-nav__link">
      فصل 13
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../chapter-14/" title="فصل ۱۴" class="md-nav__link">
      فصل ۱۴
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../chapter-15/" title="فصل پانزدهم" class="md-nav__link">
      فصل پانزدهم
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../chapter-16/" title="فصل ۱۶" class="md-nav__link">
      فصل ۱۶
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../chapter-17/" title="فصل هفدهم" class="md-nav__link">
      فصل هفدهم
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../chapter-18/" title="فصل ۱۸ - ارث‌بری" class="md-nav__link">
      فصل ۱۸ - ارث‌بری
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" title="فصل ۱۹" class="md-nav__link md-nav__link--active">
      فصل ۱۹
    </a>
    
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="_1">فصل ۱۹</h1>
<p>چیزای خوب</p>
<p>یکی از اهداف من برای نوشتن این کتاب این بود تا آنجایی که درتوانم هست به
شما اندکی پایتون یاد بدهم. وقتی در سر دوراهی انجام کاری بودم یکی را
انتخاب می کردم و به راه دیگر اشاره ای نمی کردم. یا این که راه دوم را در
یک تمرین می گذاشتم.</p>
<p>حالا من قصد دارم به یک سری خرده ریز خوب که پشت سر گذاشته ام برگردم.
پایتون تعدادی قابلیت دارد که در واقع ضروری نیستند – و شما می توانید بدون
دانستن آنها کدهای خوبی بنویسید- اما با این ویژگی ها می توانید کدهایی
بنویسید که مختصر ، خوانا ویا موثرتر باشد و در اغلب موارد هر سه این موارد</p>
<p>۱-۱۹عبارت های شرطی</p>
<p>ما در توضیحات بخش ۵.۴ دیدیم که عبارات شرطی اغلب برای انتخاب بین یک یا دو
مقدار استفاده می شود.به عنوان مثال:</p>
<p>if x &gt; 0:</p>
<p>y = math.log(x)</p>
<p>else:</p>
<p>y = float('nan')</p>
<p>این عبارت کنترل می کد که x مثبت است یا خیر. اگر باشد math.log.را محاسبه
می کند. اگر نباشد math.log مقدار خطا را برمی گرداند. برای اجتناب از توقف
برنامه ما “NaN” را ساختیم که یک مقدار خاص شناور-ممیز دار است تا نشان دهد
این یک عدد نیست.</p>
<p>ما می توانیم این قسمت را با عبارت شرطی بسیار موجزتر بنویسیم:</p>
<p>y = math.log(x) if x &gt; 0 else float('nan')</p>
<p>شما می توانید این خط را مثل یک جمله انگلیسی هم بنویسید: y لوگ x را می
گیرد اگر که x بزرگتر از صفر باشد در غیر اینصورت NaN را می گیرد.</p>
<p>توابع بازگشتی در اکثر موارد می توانند به صورت عبارات شرطی نوشته شوند.
برای مثال تابع بازگشتی فاکتوریل را اینجا می آوریم:</p>
<p>def factorial(n):</p>
<p>if n == 0:</p>
<p>return 1</p>
<p>else:</p>
<p>return n * factorial(n-1)</p>
<p>ما می توانیم آنرا به شکل زیر بازنویسی کنیم</p>
<p>def factorial(n):</p>
<p>return 1 if n == 0 else n * factorial(n-1)</p>
<p>یکی دیگر از کاربردهای عبارات شرطی مدیریت متغیرهای اختیاری است. برای مثال
اینجا یک روش شروع از است. (تمرین ۱۷.۲ را ببینید)</p>
<p>def __init__(self, name, contents=None):</p>
<p>self.name = name</p>
<p>if contents == None:</p>
<p>contents = [ ]</p>
<p>self.pouch_contents = contents</p>
<p>ما می توانیم این یکی را هم به شکل زیر بازنویسی کنیم:</p>
<p>def __init__(self, name, contents=None):</p>
<p>self.name = name</p>
<p>self.pouch_contents = [] if contents == None else contents</p>
<p>در حالت کلی، شما می توانید یک قسمت از برنامه شرطی را به شکل عبارات شرطی
بنویسید اگر هر دو شاخه شامل عبارات ساده ای باشد که یا به یک متغیر مشابه
اخصاص یافته و یا مقدار را برگرداند.</p>
<p>۲-۱۹ درک لیست</p>
<p>در بخش ۷-۱۰ الگوهای فیلتر کردن و مپ را دیدیم. برای مثال این تابع یک لیست
رشته ای از ما می گیرد، با روش capitalize رشته را به عناصر مپ کرده و یه
لیست جدید رشته ای را بر می گرداند:</p>
<p>def capitalize_all(t):</p>
<p>res = []</p>
<p>for s in t:</p>
<p>res.append(s.capitalize())</p>
<p>return res</p>
<p>ما می توانیم آن رابا درک لیست ها خیلی خلاصه تر بنویسیم:</p>
<p>def capitalize_all(t):</p>
<p>return [s.capitalize() for s in t]</p>
<p>عملگر براکت اشاره به این دارد که ما در حال ساختن یک لیست جدید هستیم.
عبارت داخل براکت عناصر لیست را مشخص می کند، و قسمت for اشاره می کند که
کدام sequence را باید پیمایش کنیم.</p>
<p>کدهای مربوط به درک لیست یک مقدار وحشتناک به نظر می رسد به خاطر متغیرهای
حلقه for ، s در این مثال در عبارت ظاهر شده است قبل از اینکه ما آنرا
تعریف کنیم.</p>
<p>درک لیست همچنین می تواند برای فربال و فلیتر کردن هم استفاده شود. برای
مقال این تابع عناصری را انتخاب می کند که فقط t در آن ها با حروف بزرگ
باشد و سپس لیست جدید را بر می گرداند:</p>
<p>def only_upper(t):</p>
<p>res = []</p>
<p>for s in t:</p>
<p>if s.isupper():</p>
<p>res.append(s)</p>
<p>return res</p>
<p>ما میتوانیم آنرا با استفاده از درک لیست به شکل زیر دوباره نویسی کنیم:</p>
<p>def only_upper(t):</p>
<p>return [s for s in t if s.isupper()]</p>
<p>درک لیست بسیار مختصر و ساده خوانده می شود به همچنین برای عبارات ساده. و
آن ها معمولا سریعتر از معادل های حلقه ای شان هستند و دراغلب موارد خیلی
خیلی سریع تر هستند. بنابر این اگر بنده را دیوانه بخوانید که چرا این ها
را زودتر نگفتم شما را درک می کنم.</p>
<p>اما در دفاع از خودم باید بگویم درک لیست ها برای دیباگ کردن سخت تر هستند
به علت اینکه شما نمی توانید یک دستور پرینت در یه تکه از برنامه ی داخل
حلقه بگنجانید. من پیشنهاد می کنم شما آن را زمانی استفاده کنید که محاسبات
ساده ای دارید تا آنرا برای اولین بار به طور صحیح درک کنید. و این برای
برای تازه کارها یعنی هرگز استفاده نکنید.</p>
<p>۳-۱۹ عبارات مولد</p>
<p>عبارات مولد (تولید کننده) شبیه عبارات درک لیست هستند اما همراه با پرانتز
بر خلاف براکت ها:</p>
<p>&gt;&gt;&gt; g = (x**2 for x in range(5))</p>
<p>&gt;&gt;&gt; g</p>
<p>&lt;generator object &lt;genexpr&gt; at 0x7f4c45a786c0&gt;</p>
<p>نتیجه یک شیئ مولد است که می داند چگونه در میان کدام sequence از متغیرها
تکرار شود. اما بر خلاف درک لیست نمی تواند تمام مقادیر را در لحظه محاسبه
کند. مولد صبر می کند تا از او پرسیده شود.</p>
<p>تابع توکار next مقداربعدی را از مولد می گیرد:</p>
<p>&gt;&gt;&gt; next(g)</p>
<p>0</p>
<p>&gt;&gt;&gt; next(g)</p>
<p>1</p>
<p>وقتی شما به پایان sequence می رسید next دستور رد شدن با توقف تکرار را
بالا می برد. شما همچنین می توانید از حلقه ی for برای تکرار میان مقادیر
استفاده کنید.</p>
<p>&gt;&gt;&gt; for val in g:</p>
<p>... print(val)</p>
<p>4</p>
<p>9</p>
<p>16</p>
<p>شیئ مولد ردپای اینکه کجای sequence است را نگه داشته و بنابراین حلقه for
از آنجاییکه next رفته است ادامه می دهد. هر گاه مولد خسته شود
StopException را بالا می آورد:</p>
<p>&gt;&gt;&gt; next(g)</p>
<p>StopIteration</p>
<p>عبارت های مولد اغلب با توابعی مثل sum,max و min استفاده می شوند:</p>
<p>&gt;&gt;&gt; sum(x**2 for x in range(5))</p>
<p>30</p>
<p>۴-۱۹ any و all</p>
<p>پایتون یک تابع تو کار any را فراهم می کند برای اینکه sequence مقدار
بولین بگیرد . True برگرداند هر وقت تمام مقادیر True باشند. این هم بر روی
لیست ها کار می کند:</p>
<p>&gt;&gt;&gt; any([False, False, True])</p>
<p>True</p>
<p>اما اغلب با عبارت مولد کار می کند:</p>
<p>&gt;&gt;&gt; any(letter == 't' for letter in 'monty')</p>
<p>True</p>
<p>این مثال خیلی مفید نیست چون شبیه عملگر in است. اما می توانیم any را برای
دوباره نویسی برخی از توابع جستجو که در فصل ۹.۳ نوشتیم بکار ببریم.برای
مثال می توانیم avoid را شبیه ذیل بنویسیم:</p>
<p>def avoids(word, forbidden):</p>
<p>return not any(letter in forbidden for letter in word)</p>
<p>اگر بخواهیم مثل یک جمله ی معمولی انرا بخوانیم اینطور می شود: word از
forbidden اجتناب می کند اگر کلمه ی forbidden در wordوجود نداشته باشد.</p>
<p>استفاده کردن از any همراه عبارات مولد کافیست زیرا می تواند به ناگاه
بایستد اگر مقدار True را بیابد پس مجبور نیست تمام sequence را ارزیابی
کند.</p>
<p>پایتون یک تابع توکار دیگری فراهم می آورد، all مقدار True برمی گرداند اگر
هر کدام از عناصر sequence, True باشند. مانند مثال از all استفاده کنید تا
uses-all از بخش ۹.۳ را دوباره بنویسید.</p>
<p>۵- ۱۹ مجموعه ها</p>
<p>در بخش ۱۳.۶ از فرهنگ لغت استفاده کردیم تا کلماتی را که در یک سند بود
پیدا کند اما در در یک لیست کلمات. تابعی که من نوشته ام d1 شامل تمام
کلمات سند است به عنوان کلید ها و d2 شامل تمام لیست لغات است. این برنامه
فرهنگ لغتی را بر می گرداند که شامل کلیدها از d1 باشد و نه در d2</p>
<p>def subtract(d1, d2):</p>
<p>res = dict()</p>
<p>for key in d1:</p>
<p>if key not in d2:</p>
<p>res[key] = None</p>
<p>return res</p>
<p>در تمام این فرهنگ لغات مقدار None می باشد چرا که ما از آن ها استفاده
نکرده ایم. در نتیجه ما مقداری از فضای انباره را اشغال کرده ایم.</p>
<p>پایتون یک نوع دیگر از توکارها را که set یا مجموعه نامیده می شود فراهم
کرده است که مانند یک کلکسیون از کلیدهای فرهنگ لغت بدون مقدار رفتار می
کنند. اضافه کردن عناصر به مجموعه سریع است و همچنین عضویت در آن. و set ها
روش ها و عملگرهایی برای محاسبه عملیات های معمول مجموعه فراهم کرده اند.</p>
<p>برای مثال کم کردن از مجموعه در روشی و یا در عملگری به نام difference
موجود است پس ما می توانیم subtract (کم کردن) را به شکل ذیل بازنویسی
کنیم:</p>
<p>def subtract(d1, d2):</p>
<p>return set(d1) - set(d2)</p>
<p>نتیجه یک مجموعه است بر خلاف فرهنگ لغت اما در این عملیات مانند تکرار
رفتار ها مشابه است.</p>
<p>خیلی از تمرینات این کتاب می تواند با مجموعه ها مختصر و مفید انجام شود.
برای مثال اینجا راه حلی برای has_duplicates از تمرین ۱۰.۷ که از فرهنگ
لغات استفاده می کند آورده ام:</p>
<p>def has_duplicates(t):</p>
<p>d = {}</p>
<p>for x in t:</p>
<p>if x in d:</p>
<p>return True</p>
<p>d[x] = True</p>
<p>return False</p>
<p>وقتی یک عنصر برای اولین بار ظاهر می شود به فرهنگ لغات اضافه می شود اگر
عنصر مشابه دوباره ظاهر شود تابع مقدار True را بر می گرداند.</p>
<p>با ساتفاده از مجموعه ها می توانیم یک تابع مشابه به صورت ذیل بنویسیم:</p>
<p>def has_duplicates(t):</p>
<p>return len(set(t)) &lt; len(t)</p>
<p>یک عنصر در یک مجموعه فقط یکبار ظاهر می شود پس اگر یک عنصر بیشتر از یکبار
ظاهر شود مجموعه کوچکتر از t خواهد بود.اگر هیچ تکراری وجود نداشته باشد
مجموعه و t هم اندازه هستند.</p>
<p>ما همچنین مجموعه ها را برای استفاده در تمرین های بخش ۹ کتاب استفاده می
کنیم. به عنوان مثال یک نسخه از uses_only را باحلقه در اینجا داریم:</p>
<p>def uses_only(word, available):</p>
<p>for letter in word:</p>
<p>if letter not in available:</p>
<p>return False</p>
<p>return True</p>
<p>uses_only کنترل می کند که تمام لغات در word در available باشند. حالا
آنرا به این شکل بازنویسی می کنیم:</p>
<p>def uses_only(word, available):</p>
<p>return set(word) &lt;= set(available)</p>
<p>عملگر &lt;= کنترل می کند که یک مجموعه زیر مجموعه دیگری است یا خیر به
همچنین احتمال مساوی بودن دارند یا نه که اگر درستباشد تمامی حروف در word
در available وجود دارند.</p>
<p>مانند تمرینات قبل avoids را با استفاده از مجموعه ها بنویسید.</p>
<p>۱۹-۶ شمارنده ها</p>
<p>یک شمارنده شبیه یک مجموعه است با این تفاوت که اگر عنصری بیش از یک بار
ظاهر شود شمارنده تعداد ظاهر شدنش را نگه می دارد.اگر شما با مقوله ی
multiset در ریاضیات آشنا باشید شمارنده یه راه طبیعی برای نشان دادن
multiset است</p>
<p>شمارنده یک ماژول استاندارد به نام collections تعریف کرده و شما می توانید
آنرا به درون بیاورید Import it. شما می توانید یک شمارنده را با یک لیست
رشته ای یا با هر چیزی که تکرار را پشتیبانی می کند بهینه کنید:</p>
<p>&gt;&gt;&gt; from collections import Counter</p>
<p>&gt;&gt;&gt; count = Counter('parrot')</p>
<p>&gt;&gt;&gt; count</p>
<p>Counter({'r': 2, 't': 1, 'o': 1, 'p': 1, 'a': 1})</p>
<p>شمارنده ها مانند فرهنگ لغات در بسیاری از موارد عمل می کنند. آنها هر کلید
را به تعداد ظاهر شدن map می کنند. مانند فرهنگ لغات کلیدها باید قابل
hashشدن باشند</p>
<p>برخلاف فرهنگ لغات شمارنده ها هنگام دسترسی به یک عنصری که ظاهر نشده است
یک استثناء بالا نمی آورند در عوض مقدار صفر را بر می گردانند:</p>
<p>&gt;&gt;&gt; count['d']</p>
<p>0</p>
<p>شمارنده را برای بازنویسی is_anagram از تمرین ۱۰.۶ بکار می بریم:</p>
<p>def is_anagram(word1, word2):</p>
<p>return Counter(word1) == Counter(word2)</p>
<p>اگر دو کلمه هم خانواده باشند آن ها از حروف مشابه و تعداد مشابه حروف
برخوردارند پس شمارنده ها نیز مساوی هستند.</p>
<p>شمارنده ها روش ها و عملیاتی را برای اجرای عملگر شبه مجموعه set-like
فراهم کرده اند، شامل اضافه کردن، کم کردن، اجتماع و رسیدن.</p>
<p>و روشی که معمولا مفید واقع می شود most_common را نیز فراهم کرده اند تا
یک لیست از جفت های دارای ارزش تکرار به صورت مرتب شده از متدوال ترین تا
آخر برگرداند</p>
<p>&gt;&gt;&gt; count = Counter('parrot')</p>
<p>&gt;&gt;&gt; for val, freq in count.most_common(3):</p>
<p>... print(val, freq)</p>
<p>r 2</p>
<p>p 1</p>
<p>a 1</p>
<p>۷-۱۹ defaultdict (فرهنگ لغت پیشفرض)</p>
<p>ماژول Collections ماژول defaultdict را هم فراهم می آورد که شبیه فرهنگ
لغت dictionaryاست جز در این مورد که اگر شما به کلیدی رسیدید که وجود
نداشت آن می تواند بvای شما یک مقدار جدید در حین عملکردش بسازد.</p>
<p>وقتی شما defaultdict را ساختید یک تابع که برای ساختن مقدار جدید استفاده
می شود را فراهم کرده اید. یک تابع که برای ساخت اشیایی بکار می رود که
معمولا factory نامیده می شوند. یک تابع توکار که لیست ها،مجموعه ها و سایر
چیزهایی که ممکن است توسط factory استفاده شود را می سازد:</p>
<p>&gt;&gt;&gt; from collections import defaultdict</p>
<p>&gt;&gt;&gt; d = defaultdict(list)</p>
<p>خاطر نشان می کنم که نشانوند ما list است که یک class object است نه list()
که یک لیست جدید است. تابعی که شما فراهم آورده اید تاهنگامی که به کلیدی
بر نخورد که وجود نداشته باشد فراخوانده نمی شود.</p>
<p>&gt;&gt;&gt; t = d['new key']</p>
<p>&gt;&gt;&gt; t</p>
<p>[]</p>
<p>لیست جدید که ما آنرا t می خوانیم نیز به dictionary اضافه شد. پس اگر ما t
را تغییر دهیم تغییرات در d ظاهر می شود:</p>
<p>&gt;&gt;&gt; t.append('new value')</p>
<p>&gt;&gt;&gt; d</p>
<p>defaultdict(&lt;class 'list'&gt;, {'new key': ['new value']})</p>
<p>اگر شما یک dictionary از لیست ها ساخته اید اغلب باید بتوانید کد ساده تری
با استفاده از defaultdict بنویسید. در راه حل های من در تمرین ۱۲.۲ که شما
از<a href="http://thinkpython2.com/code/anagram_sets.py">
</a><a href="http://thinkpython2.com/code/anagram_sets.py"><em>http</em></a><a href="http://thinkpython2.com/code/anagram_sets.py"><em>://</em></a><a href="http://thinkpython2.com/code/anagram_sets.py"><em>thinkpython</em></a><a href="http://thinkpython2.com/code/anagram_sets.py"><em>2.</em></a><a href="http://thinkpython2.com/code/anagram_sets.py"><em>com</em></a><a href="http://thinkpython2.com/code/anagram_sets.py"><em>/</em></a><a href="http://thinkpython2.com/code/anagram_sets.py"><em>code</em></a><a href="http://thinkpython2.com/code/anagram_sets.py"><em>/</em></a><a href="http://thinkpython2.com/code/anagram_sets.py"><em>anagram</em></a><a href="http://thinkpython2.com/code/anagram_sets.py"><em>_</em></a><a href="http://thinkpython2.com/code/anagram_sets.py"><em>sets</em></a><a href="http://thinkpython2.com/code/anagram_sets.py"><em>.</em></a><a href="http://thinkpython2.com/code/anagram_sets.py"><em>py</em></a>
دریافت کردید من یک dictionary ساختم که مپ شده بود از رشته های مرتب شده
بر اساس حروف لغات که با آن حروف می توان کلمات را هجی کرد. برای مثال
'opst' به لیست ['opts','post', 'pots', 'spot', 'stop', 'tops']مپ شده
است.</p>
<p>این هم از کد اصلی:</p>
<p>def all_anagrams(filename):</p>
<p>d = {}</p>
<p>for line in open(filename):</p>
<p>word = line.strip().lower()</p>
<p>t = signature(word)</p>
<p>if t not in d:</p>
<p>d[t] = [word]</p>
<p>else:</p>
<p>d[t].append(word)</p>
<p>return d</p>
<p>این می تواند با استفاده از setdefault که ممکن است شما در تمرین ۱۱.۲
استفاده کرده باشید، ساده شود:</p>
<p>def all_anagrams(filename):</p>
<p>d = {}</p>
<p>for line in open(filename):</p>
<p>word = line.strip().lower()</p>
<p>t = signature(word)</p>
<p>d.setdefault(t, []).append(word)</p>
<p>return d</p>
<p>این راه حل یک اشکال دارد، اینکه هر بار یک لیست می سازد بدون در نظر گرفتن
اینکه چه چیزی مورد نیاز است. برای لیست ها خیلی مساله ی خاصی نیست اما اگر
تابع عمکردی پیچیده داشته باشیم ممکن است مشکل پیش بیاید.</p>
<p>می توانیم ازین معضل با ساده سازی کد بااستفاده از defaultdict اجتناب
کنیم.</p>
<p>def all_anagrams(filename):</p>
<p>d = defaultdict(list)</p>
<p>for line in open(filename):</p>
<p>word = line.strip().lower()</p>
<p>t = signature(word)</p>
<p>d[t].append(word)</p>
<p>return d</p>
<p>راه حل من در تمرین ۱۸.۳ که شما از<a href="http://thinkpython2.com/code/PokerHandSoln.py">
</a><a href="http://thinkpython2.com/code/PokerHandSoln.py"><em>http</em></a><a href="http://thinkpython2.com/code/PokerHandSoln.py"><em>://</em></a><a href="http://thinkpython2.com/code/PokerHandSoln.py"><em>thinkpython</em></a><a href="http://thinkpython2.com/code/PokerHandSoln.py"><em>2.</em></a><a href="http://thinkpython2.com/code/PokerHandSoln.py"><em>com</em></a><a href="http://thinkpython2.com/code/PokerHandSoln.py"><em>/</em></a><a href="http://thinkpython2.com/code/PokerHandSoln.py"><em>code</em></a><a href="http://thinkpython2.com/code/PokerHandSoln.py"><em>/</em></a><a href="http://thinkpython2.com/code/PokerHandSoln.py"><em>PokerHandSoln</em></a><a href="http://thinkpython2.com/code/PokerHandSoln.py"><em>.</em></a><a href="http://thinkpython2.com/code/PokerHandSoln.py"><em>py</em></a>
دریافت کردید استفاده از setdefault در تابع has_straightflush است. این
راه حل این مشکل را در ساختن شیئ hand هر بار که در حلقه می افتد دارد خواه
نیاز باشد یا نباشد.مانند تمرین آنرا با defaultdict دوباره نویسی کنید.</p>
<p>۸-۱۹Named tuples</p>
<p>اساسا خیلی از اشیاء مجموعه ای از ارزش های بهم مرتبط هستند. بعنوان مثال
شیء Point که در فصل ۱۵ تعریف شد شامل دو عدد x و y است. وقتی شما یک کلاس
را مانند این تعریف می کنید شما بطور معمول با حالت init و str شروع کرده
اید:</p>
<p>class Point:</p>
<p>def __init__(self, x=0, y=0):</p>
<p>self.x = x</p>
<p>self.y = y</p>
<p>def __str__(self):</p>
<p>return '(%g, %g)' % (self.x, self.y)</p>
<p>مقادیر زیادی از کدها وجود دارد تا مقدار کمتری از اطلاعات را انتقال دهد.
پایتون یک راه بسیار مختصر را برای بیان یک حرف مشترک فراهم می آورد:</p>
<p>from collections import namedtuple</p>
<p>Point = namedtuple('Point', ['x', 'y'])</p>
<p>اولین نشانوندی که بریا ساختن یک کلاس انتخاب می کنید نام کلاس است. دومین
آن که باید داشته باشید یک فهرست از خصوصیات شیء Point است مانند رشته ها.
ارزشی که از namedtuple برگردانده می شود یک شیء کلاس (class object) است:</p>
<p>&gt;&gt;&gt; Point</p>
<p>&lt;class '__main__.Point'&gt;</p>
<p>Point بصورت اتوماتیک روش هایی شبیه –init-- و –str— را فراهم می کند پس
شما نیاز ندارید تا آن ها را بنویسید.</p>
<p>برای ساختن شیء Point شما از کلاس Point بعنوان یک تابع استفاده می کنید:</p>
<p>&gt;&gt;&gt; p = Point(1, 2)</p>
<p>&gt;&gt;&gt; p</p>
<p>Point(x=1, y=2)</p>
<p>روش آغازین (init) نشانوندها را به خصوصیاتی که شما نامگذاری کرده اید
پیوند می دهد. روش srt شیء Point و خصوصیات آن را نمایش می دهد.</p>
<p>شما می توانید به عناصر named tuple بااسم دسترسی پیدا کنید:</p>
<p>&gt;&gt;&gt; p.x, p.y</p>
<p>(1, 2)</p>
<p>اما شما می توانید با named tuple مانند یک tuple (چند تایی) رفتار کنید:</p>
<p>&gt;&gt;&gt; p[0], p[1]</p>
<p>(1, 2)</p>
<p>&gt;&gt;&gt; x, y = p</p>
<p>&gt;&gt;&gt; x, y</p>
<p>(1, 2)</p>
<p>Named tuples یک راه سریع برای تعریف کلاس های ساده است. یک اشکال آن اینست
که کلاس های ساده همیشه ساده نمی مانند. ممکن است شما در آینده تصمیم
بگیرید که روش های دیگری را به named tuple اضافه کنید. در آنصورت باید یک
کلاس جدید تعریف کنید که از named tuple ارثبری کند:</p>
<p>class Pointier(Point):</p>
<p># add more methods here</p>
<p>یا اینکه به روش سنتی تعریف کلاس برگردید.</p>
<p>۹-۱۹ گردآوری لغات کلیدی آرگومان ها</p>
<p>در قسمت ۱۲.۴ دیدیم که چگونه یک تابع نوشت تا آرگومان ها (نشانوند ها) را
درون یک tuple جمع آوری کند.</p>
<p>def printall(*args):</p>
<p>print(args)</p>
<p>شما می توانید این تابع را با هر عدد از آرگومان های مکانی فراخوانی کنید (
که آرگومان هایی هستند که لغات کلیدی ندارند):</p>
<p>&gt;&gt;&gt; printall(1, 2.0, '3')</p>
<p>(1, 2.0, '3')</p>
<p>اما عملگر * آرگومان های کلمات کلیدی را گردآوری نمی کند:</p>
<p>&gt;&gt;&gt; printall(1, 2.0, third='3')</p>
<p>TypeError: printall() got an unexpected keyword argument 'third'</p>
<p>برای گردآوری آرگومان های کلمات کلیدی می توانید از عملگر ** استفاده
کنید:</p>
<p>def printall(*args, **kwargs):</p>
<p>print(args, kwargs)</p>
<p>شما می توانید پارامتر گردآوری لغات را به هر گونه که بخواهید فراخوانی
کنید، اما kwargs یک انتخاب معمولی است. نتیجه، یک فرهنگ لغات است که لغات
کلیدی را به ارزش ها مپ کرده است:</p>
<p>&gt;&gt;&gt; printall(1, 2.0, third='3')</p>
<p>(1, 2.0) {'third': '3'}</p>
<p>اگر شما یک فرهنگ لغت از کلمات کلیدی و ارزشها داشته باشید می توانید از
عملگر جداکننده ** برای فراخوانی تابع استفاده کنید:</p>
<p>&gt;&gt;&gt; d = dict(x=1, y=2)</p>
<p>&gt;&gt;&gt; Point(**d)</p>
<p>Point(x=1, y=2)</p>
<p>بدون عملگر جداکننده تابع d مانند آرگومان مکانی تنها عمل می کند پس d را
به x اختصاص می دهد و شکایت می کند چرا که هیچ چیزی برای اختصاص دادن به y
ندارد:</p>
<p>&gt;&gt;&gt; d = dict(x=1, y=2)</p>
<p>&gt;&gt;&gt; Point(d)</p>
<p>Traceback (most recent call last):</p>
<p>File "&lt;stdin&gt;", line 1, in &lt;module&gt;</p>
<p>TypeError: __new__() missing 1 required positional argument: 'y'</p>
<p>وقتی شما مشغول کارکردن با توابع هستید که تعداد زیادی از پارامترها را
دارد خیلی مفید است فرهنگ لغت ها را بسازید و توزیع کنید تا گزینه های زیاد
استفاده شده را مشخص کند.</p>
<p>۱۰-۱۹ واژه نامه</p>
<p>عبارت شرطی : عبارتی که بسته به شرط یکی از دو ارزش را داشته باشد.</p>
<p>درک لیست: یک عبارنت با حلقه ی for در براکت های دوگانه که لیست جدید بازده
ی آن است.</p>
<p>عبارت مولد: عبارتی است با حلقه ی for در پرانتزها که یک مولد شیء را به
بار می آورد.</p>
<p>چندمجموعه: یک موجودیت ریاضی که مپ شدن بین عناصر یک مجموعه و تعدد ظهور
آنان را نشان می دهد.</p>
<p>کارخانه: یک تابع که معمولا مانند پارامتر برای ساخت اشیاء استفاده می شود.</p>
<p>۱۱-۱۹ تمرین ها</p>
<p>تمرین ۱-۱۹</p>
<p>در ذیل یک تابع آورده شده که ضریب دوجمله ای را بصورت بازگشتی محاسبه می
کند.</p>
<p>def binomial_coeff(n, k):</p>
<p>"""Compute the binomial coefficient "n choose k".</p>
<p>n: number of trials</p>
<p>k: number of successes</p>
<p>returns: int</p>
<p>"""</p>
<p>if k == 0:</p>
<p>return 1</p>
<p>if n == 0:</p>
<p>return 0</p>
<p>res = binomial_coeff(n-1, k) + binomial_coeff(n-1, k-1)</p>
<p>return res</p>
<p>بدنه تابع را با عبارات شرطی تودرتو بازنویسی کنید.</p>
<p>یک یادداشت: این تابع خیلی کارا نیست چون تا محاسبه ی ارزش های برابر ادامه
می دهد. شما می توانید این را با memorizing بسیار کاراتر کنید. (بخش ۱۱.۶
را ببینید) اما شما خواهید فهمید که memorize کردن بسیار سخت تر است اگر از
عبارات شرطی در نوشتن برنامه استفاده کنید.</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../chapter-18/" title="فصل ۱۸ - ارث‌بری" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  قبلی
                </span>
                فصل ۱۸ - ارث‌بری
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>